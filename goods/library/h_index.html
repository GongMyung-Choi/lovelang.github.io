<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>루웨인 전자도서관 | 인간용 인덱스</title>
<style>
body{font-family:'Noto Sans KR',sans-serif;background:#f8f8f8;margin:0;}
header{background:#3a655c;color:#fff;padding:18px;text-align:center;font-size:1.5rem;font-weight:700;}
main{max-width:1100px;margin:0 auto;padding:24px;}
.section{margin-bottom:40px;}
.section h2{color:#3a655c;border-left:6px solid #3a655c;padding-left:10px;margin-bottom:12px;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px;}
.card{background:#fff;border-radius:12px;box-shadow:0 3px 6px rgba(0,0,0,0.12);padding:16px;}
.card h3{margin:0 0 6px;font-size:1.1rem;color:#2a9d8f;}
.badges{margin-top:4px;}
.badge{display:inline-block;background:#d9eee6;color:#333;padding:4px 8px;border-radius:6px;font-size:0.8rem;margin:2px;}
footer{text-align:center;padding:16px;color:#666;font-size:0.9rem;}
</style>
</head>
<body>
<header>📚 루웨인 전자도서관 (인간용)</header>
<main id="library"></main>
<footer>루웨인 디지털 라이브러리 © 2025</footer>

<script>
// 📘 도서 목록 (자동 생성 예정)
const books = [
  './papers/h_101/summary.txt',
  './papers/h_205/summary.txt',
  './papers/h_301/summary.txt',
  './papers/h_403/summary.txt',
  './papers/h_601/summary.txt'
];

// 📘 summary 분석 함수
async function parseSummary(path){
  const res = await fetch(path);
  const text = await res.text();
  const title = (text.match(/Title:\s*(.*)/i)||[])[1]||'제목 미상';
  const category = (text.match(/Category:\s*(.*)/i)||[])[1]||'미분류';
  const tagsLine = (text.match(/Tags:\s*(.*)/i)||[])[1]||'';
  const summary = (text.match(/Summary:\s*([\s\S]*)/i)||[])[1]||'';
  const tags = tagsLine.split(/[#,]/).map(t=>t.trim()).filter(Boolean);

  // 자동 감응 태그 추가 (표시용, 분류 아님)
  const extra = [];
  const lower = summary.toLowerCase();
  if(/언어|말|communication/.test(lower)) extra.push('언어');
  if(/철학|존재|의미|philosophy/.test(lower)) extra.push('철학');
  if(/예술|art|감성|창의/.test(lower)) extra.push('예술');
  if(/기술|ai|인공지능|system|tech/.test(lower)) extra.push('기술');
  if(/치유|therapy|회복|healing/.test(lower)) extra.push('치유');

  // 태그 중복 제거
  const allTags = [...new Set([...tags, ...extra])];
  return { title, category, tags: allTags, summary };
}

// 📘 인덱스 구축 (카테고리 1개만)
async function buildLibrary(){
  const container = document.getElementById('library');
  const items = await Promise.all(books.map(parseSummary));
  const grouped = {};

  // 한 권당 카테고리 하나만
  items.forEach(({title,category,tags,summary})=>{
    if(!grouped[category]) grouped[category]=[];
    grouped[category].push({title,tags,summary});
  });

  // 출력
  for(const cat in grouped){
    const section=document.createElement('section');
    section.className='section';
    section.innerHTML=`<h2>${cat}</h2><div class="grid"></div>`;
    const grid=section.querySelector('.grid');
    grouped[cat].forEach(({title,tags,summary})=>{
      const div=document.createElement('div');
      div.className='card';
      const badges=tags.map(t=>`<span class="badge">#${t}</span>`).join('');
      div.innerHTML=`<h3>${title}</h3><p>${summary.slice(0,100)}...</p><div class="badges">${badges}</div>`;
      grid.appendChild(div);
    });
    container.appendChild(section);
  }
}
buildLibrary();
</script>
</body>
</html>
